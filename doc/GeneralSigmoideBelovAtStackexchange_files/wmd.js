'use strict';var Markdown={};
(function(){function n(l){return l}function x(){return!1}function q(){}function u(){}q.prototype={chain:function(l,o){var t=this[l];if(!t)throw Error("unknown hook "+l);this[l]=t===n?o:function(l){var j=Array.prototype.slice.call(arguments,0);j[0]=t.apply(null,j);return o.apply(null,j)}},set:function(l,o){if(!this[l])throw Error("unknown hook "+l);this[l]=o},addNoop:function(l){this[l]=n},addFalse:function(l){this[l]=x}};Markdown.HookCollection=q;u.prototype={set:function(l,o){this["s_"+l]=o},get:function(l){return this["s_"+
l]}};Markdown.Converter=function(){function l(a){return a=a.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(a,d,L,e,c,m){d=d.toLowerCase();F.set(d,b(L));if(c)return e;m&&G.set(d,m.replace(/"/g,"&quot;"));return""})}function o(a){a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,n);a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,
n);a=a.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,n);a=a.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,n);return a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,n)}function n(a,b){var d;d=b.replace(/^\n+/,"");d=d.replace(/\n+$/g,"");return d="\n\n~K"+(H.push(d)-1)+"K\n\n"}function s(a,b){a=z.preBlockGamut(a,K);a=B(a);a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,"<hr />\n");a=a.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,
"<hr />\n");a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,"<hr />\n");a=h(a);a=E(a);a=c(a);a=z.postBlockGamut(a,K);a=o(a);return a=e(a,b)}function j(a){a=z.preSpanGamut(a);a=v(a);a=x(a);a=a.replace(/\\(\\)/g,A);a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,A);a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,p);a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,p);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,y);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,
y);a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,y);a=g(a);a=a.replace(/~P/g,"://");a=b(a);a=a.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4");a=a.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4");a=a.replace(/  +\n/g," <br>\n");return a=z.postSpanGamut(a)}function x(a){return a=a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi,function(a){var b=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=
r(b,"!"==a.charAt(1)?"\\`*_/":"\\`*_")})}function y(a,b,d,e,c,k,g,A){void 0==A&&(A="");a=d.replace(/:\/\//g,"~P");e=e.toLowerCase();if(""==c)if(""==e&&(e=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=F.get(e))c=F.get(e),void 0!=G.get(e)&&(A=G.get(e));else if(-1<b.search(/\(\s*\)$/m))c="";else return b;c=m(c);c=r(c,"*_");b='<a href="'+c+'"';""!=A&&(A=i(A),A=r(A,"*_"),b+=' title="'+A+'"');return b+(">"+a+"</a>")}function i(a){return a.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}
function p(a,b,d,e,c,m,k,g){a=d;e=e.toLowerCase();g||(g="");if(""==c)if(""==e&&(e=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=F.get(e))c=F.get(e),void 0!=G.get(e)&&(g=G.get(e));else return b;a=r(i(a),"*_[]()");c=r(c,"*_");b='<img src="'+c+'" alt="'+a+'"';g=i(g);g=r(g,"*_");return b+(' title="'+g+'"')+" />"}function B(a){a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,b){return"<h1>"+j(b)+"</h1>\n\n"});a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,b){return"<h2>"+j(b)+"</h2>\n\n"});return a=
a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,b,d){a=b.length;return"<h"+a+">"+j(d)+"</h"+a+">\n\n"})}function h(a,b){var a=a+"~0",d=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;J?a=a.replace(d,function(a,d,e){a=-1<e.search(/[*+-]/g)?"ul":"ol";d=w(d,a,b);d=d.replace(/\s+$/,"");return"<"+a+">"+d+"</"+a+">\n"}):(d=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(d,function(a,
b,d,e){a=-1<e.search(/[*+-]/g)?"ul":"ol";d=w(d,a);return b+"<"+a+">\n"+d+"</"+a+">\n"}));return a=a.replace(/~0/,"")}function w(a,b,d){J++;var a=a.replace(/\n{2,}$/,"\n"),b=M[b],e=!1,a=(a+"~0").replace(RegExp("(^[ \\t]*)("+b+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+b+")[ \\t]+))","gm"),function(a,b,c,m){a=m;(b=/\n\n$/.test(a))||-1<a.search(/\n{2,}/)||e?a=s(I(a),!0):(a=h(I(a),!0),a=a.replace(/\n$/,""),d||(a=j(a)));e=b;return"<li>"+a+"</li>\n"}),a=a.replace(/~0/g,"");J--;return a}function E(b){b=(b+"~0").replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,
function(b,d,e){b=a(I(d));b=D(b);b=b.replace(/^\n+/g,"");b=b.replace(/\n+$/g,"");return"\n\n"+("<pre><code>"+b+"\n</code></pre>")+"\n\n"+e});return b=b.replace(/~0/,"")}function f(a){a=a.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(H.push(a)-1)+"K\n\n"}function v(b){return b=b.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(b,d,e,c){b=c.replace(/^([ \t]*)/g,"");b=b.replace(/[ \t]*$/g,"");b=a(b);b=b.replace(/:\/\//g,"~P");return d+"<code>"+b+"</code>"})}function a(a){a=a.replace(/&/g,"&amp;");
a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=r(a,"*_{}[]\\",!1)}function c(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var d;d=b.replace(/^[ \t]*>[ \t]?/gm,"~0");d=d.replace(/~0/g,"");d=d.replace(/^[ \t]+$/gm,"");d=s(d);d=d.replace(/(^|\n)/g,"$1  ");d=d.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var d;d=b.replace(/^  /mg,"~0");return d=d.replace(/~0/g,"")});return f("<blockquote>\n"+d+"\n</blockquote>")})}function e(a,b){for(var a=a.replace(/^\n+/g,
""),a=a.replace(/\n+$/g,""),d=a.split(/\n{2,}/g),e=[],c=/~K(\d+)K/,m=d.length,g=0;g<m;g++){var r=d[g];c.test(r)?e.push(r):/\S/.test(r)&&(r=j(r),r=r.replace(/^([ \t]*)/g,"<p>"),r+="</p>",e.push(r))}if(!b){m=e.length;for(g=0;g<m;g++)for(var k=!0;k;)k=!1,e[g]=e[g].replace(/~K(\d+)K/g,function(a,b){k=!0;return H[b]})}return e.join("\n\n")}function b(a){a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");return a=a.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function d(a,b,d,e){if(b)return a;if(")"!==
e.charAt(e.length-1))return"<"+d+e+">";for(var a=e.match(/[()]/g),c=b=0;c<a.length;c++)"("===a[c]?0>=b?b=1:b++:b--;var m="";0>b&&(e=e.replace(RegExp("\\){1,"+-b+"}$"),function(a){m=a;return""}));return"<"+d+e+">"+m}function g(a){a=a.replace(/(="|<)?\b(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\])])(?=$|\W)/gi,d);return a=a.replace(/<((https?|ftp):[^'">\s]+)>/gi,function(a,b){return'<a href="'+b+'">'+z.plainLinkText(b)+"</a>"})}function k(a){return a=a.replace(/~E(\d+)E/g,
function(a,b){var d=parseInt(b);return String.fromCharCode(d)})}function I(a){a=a.replace(/^(\t|[ ]{1,4})/gm,"~0");return a=a.replace(/~0/g,"")}function D(a){if(!/\t/.test(a))return a;var b=["    ","   ","  "," "],d=0,e;return a.replace(/[\n\t]/g,function(a,c){if("\n"===a)return d=c+1,a;e=(c-d)%4;d=c+1;return b[e]})}function m(a){if(!a)return"";var b=a.length;return a.replace(N,function(d,e){return"~D"==d?"%24":":"==d&&(e==b-1||/[0-9\/]/.test(a.charAt(e+1)))?":":"%"+d.charCodeAt(0).toString(16)})}
function r(a,b,d){b="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";d&&(b="\\\\"+b);return a=a.replace(RegExp(b,"g"),A)}function A(a,b){return"~E"+b.charCodeAt(0)+"E"}var z=this.hooks=new q;z.addNoop("plainLinkText");z.addNoop("preConversion");z.addNoop("postNormalization");z.addNoop("preBlockGamut");z.addNoop("postBlockGamut");z.addNoop("preSpanGamut");z.addNoop("postSpanGamut");z.addNoop("postConversion");var F,G,H,J;this.makeHtml=function(a){if(F)throw Error("Recursive call to converter.makeHtml");F=
new u;G=new u;H=[];J=0;a=z.preConversion(a);a=a.replace(/~/g,"~T");a=a.replace(/\$/g,"~D");a=a.replace(/\r\n/g,"\n");a=a.replace(/\r/g,"\n");a=D("\n\n"+a+"\n\n");a=a.replace(/^[ \t]+$/mg,"");a=z.postNormalization(a);a=o(a);a=l(a);a=s(a);a=k(a);a=a.replace(/~D/g,"$$");a=a.replace(/~T/g,"~");a=z.postConversion(a);H=G=F=null;return a};var K=function(a){return s(a)},M={ol:"\\d+[.]",ul:"[*+-]"},N=/(?:["'*()[\]:]|~D)/g}})();
(function(){var n,x,q;function u(){}function l(a){this.buttonBar=h.getElementById("wmd-button-bar"+a);this.preview=h.getElementById("wmd-preview"+a);this.input=h.getElementById("wmd-input"+a)}function o(a,c){var e=this,b=[],d=0,g="none",k,f,D,m=function(a,b){g!=a&&(g=a,b||A());!n||"moving"!=g?f=setTimeout(r,1):D=null},r=function(a){D=new t(c,a);f=void 0};this.setCommandMode=function(){g="command";A();f=setTimeout(r,0)};this.canUndo=function(){return 1<d};this.canRedo=function(){return b[d+1]?!0:!1};
this.undo=function(){e.canUndo()&&(k?(k.restore(),k=null):(b[d]=new t(c),b[--d].restore(),a&&a()));g="none";c.input.focus();r()};this.redo=function(){e.canRedo()&&(b[++d].restore(),a&&a());g="none";c.input.focus();r()};var A=function(){var e=D||new t(c);if(!e)return!1;"moving"==g?k||(k=e):(k&&(b[d-1].text!=k.text&&(b[d++]=k),k=null),b[d++]=e,b[d+1]=null,a&&a())},z=function(a){var b=!1;if((a.ctrlKey||a.metaKey)&&!a.altKey)switch(String.fromCharCode(a.charCode||a.keyCode).toLowerCase()){case "y":e.redo();
b=!0;break;case "z":a.shiftKey?e.redo():e.undo(),b=!0}b&&(a.preventDefault&&a.preventDefault(),window.event&&(window.event.returnValue=!1))},h=function(a){!a.ctrlKey&&!a.metaKey&&(a=a.keyCode,33<=a&&40>=a||63232<=a&&63235>=a?m("moving"):8==a||46==a||127==a?m("deleting"):13==a?m("newlines"):27==a?m("escape"):(16>a||20<a)&&91!=a&&m("typing"))};(function(){i.addEvent(c.input,"keypress",function(a){(a.ctrlKey||a.metaKey)&&!a.altKey&&(89==a.keyCode||90==a.keyCode)&&a.preventDefault()});var a=function(){if((n||
D&&D.text!=c.input.value)&&void 0==f)g="paste",A(),r()};i.addEvent(c.input,"keydown",z);i.addEvent(c.input,"keydown",h);i.addEvent(c.input,"mousedown",function(){m("moving")});c.input.onpaste=a;c.input.ondrop=a})();r(!0);A()}function t(a,c){var e=this,b=a.input;this.init=function(){if(i.isVisible(b)&&(c||!(h.activeElement&&h.activeElement!==b)))if(this.setInputAreaSelectionStartEnd(),this.scrollTop=b.scrollTop,!this.text&&b.selectionStart||0===b.selectionStart)this.text=b.value};this.setInputAreaSelection=
function(){if(i.isVisible(b))if(void 0!==b.selectionStart&&!x)b.focus(),b.selectionStart=e.start,b.selectionEnd=e.end,b.scrollTop=e.scrollTop;else if(h.selection&&!(h.activeElement&&h.activeElement!==b)){b.focus();var a=b.createTextRange();a.moveStart("character",-b.value.length);a.moveEnd("character",-b.value.length);a.moveEnd("character",e.end);a.moveStart("character",e.start);a.select()}};this.setInputAreaSelectionStartEnd=function(){if(!a.ieCachedRange&&(b.selectionStart||0===b.selectionStart))e.start=
b.selectionStart,e.end=b.selectionEnd;else if(h.selection){e.text=i.fixEolChars(b.value);var d=a.ieCachedRange||h.selection.createRange(),c=i.fixEolChars(d.text),k="\u0007"+c+"\u0007";d.text=k;var f=i.fixEolChars(b.value);d.moveStart("character",-k.length);d.text=c;e.start=f.indexOf("\u0007");e.end=f.lastIndexOf("\u0007")-1;if(k=e.text.length-i.fixEolChars(b.value).length){for(d.moveStart("character",-c.length);k--;)c+="\n",e.end+=1;d.text=c}a.ieCachedRange&&(e.scrollTop=a.ieCachedScrollTop);a.ieCachedRange=
null;this.setInputAreaSelection()}};this.restore=function(){void 0!=e.text&&e.text!=b.value&&(b.value=e.text);this.setInputAreaSelection();b.scrollTop=e.scrollTop};this.getChunks=function(){var a=new u;a.before=i.fixEolChars(e.text.substring(0,e.start));a.startTag="";a.selection=i.fixEolChars(e.text.substring(e.start,e.end));a.endTag="";a.after=i.fixEolChars(e.text.substring(e.end));a.scrollTop=e.scrollTop;return a};this.setChunks=function(a){a.before+=a.startTag;a.after=a.endTag+a.after;this.start=
a.before.length;this.end=a.before.length+a.selection.length;this.text=a.before+a.selection+a.after;this.scrollTop=a.scrollTop};this.init()}function s(a,c,e){var b,d,g,k=function(){var a=0;window.innerHeight?a=window.pageYOffset:h.documentElement&&h.documentElement.scrollTop?a=h.documentElement.scrollTop:h.body&&(a=h.body.scrollTop);return a},f=function(){if(c.preview){var b=c.input.value;if(!(b&&b==g)){g=b;var e=(new Date).getTime(),b=a.makeHtml(b);d=(new Date).getTime()-e;G(b)}}},D=function(){b&&
(clearTimeout(b),b=void 0);var a=0,a=d;3E3<a&&(a=3E3);b=setTimeout(f,a)};this.refresh=function(a){a?(g="",f()):D()};this.processingTime=function(){return d};var m=!0,r=function(a){var b=c.preview,d=b.parentNode,e=b.nextSibling;d.removeChild(b);b.innerHTML=a;e?d.insertBefore(b,e):d.appendChild(b)},A=function(a){c.preview.innerHTML=a},z,F=function(a){if(z)return z(a);try{A(a),z=A}catch(b){z=r,z(a)}},G=function(a){var b=p.getTop(c.input)-k();c.preview&&(F(a),e());c.preview&&(c.preview.scrollTop=(c.preview.scrollHeight-
c.preview.clientHeight)*(c.preview.scrollHeight<=c.preview.clientHeight?1:c.preview.scrollTop/(c.preview.scrollHeight-c.preview.clientHeight)));if(m)m=!1;else{var d=p.getTop(c.input)-k();n?setTimeout(function(){window.scrollBy(0,d-b)},0):window.scrollBy(0,d-b)}};(function(a,b){i.addEvent(a,"input",b);a.onpaste=b;a.ondrop=b;i.addEvent(a,"keypress",b);i.addEvent(a,"keydown",b)})(c.input,D);f();c.preview&&(c.preview.scrollTop=0)}function j(a,c,e,b,d,g,k){var f,D,m,r,A,z,F,G,v,p,o,l;function j(a){y.focus();
if(a.textOp){e&&e.setCommandMode();var d=new t(c);if(!d)return;var m=d.getChunks(),r=function(){y.focus();m&&d.setChunks(m);d.restore();b.refresh()};a.textOp(m,r)||r()}a.execute&&a.execute(e)}function s(a,b){var d=a.getElementsByTagName("span")[0];b?(d.style.backgroundPosition=a.XShift+" 0px",a.onmouseover=function(){d.style.backgroundPosition=this.XShift+" -40px"},a.onmouseout=function(){d.style.backgroundPosition=this.XShift+" 0px"},n&&(a.onmousedown=function(){h.activeElement&&h.activeElement!==
c.input||(c.ieCachedRange=document.selection.createRange(),c.ieCachedScrollTop=c.input.scrollTop)}),a.isHelp||(a.onclick=function(){if(this.onmouseout)this.onmouseout();j(this);return!1})):(d.style.backgroundPosition=a.XShift+" -20px",a.onmouseover=a.onmouseout=a.onclick=function(){})}function q(a){"string"===typeof a&&(a=d[a]);return function(){a.apply(d,arguments)}}function u(){e&&(s(o,e.canUndo()),s(l,e.canRedo()))}var y=c.input;f=void 0;D=void 0;m=void 0;r=void 0;A=void 0;z=void 0;F=void 0;G=
void 0;v=void 0;p=void 0;o=void 0;l=void 0;(function(){var b=c.buttonBar,d=document.createElement("ul");d.id="wmd-button-row"+a;d.className="wmd-button-row";var d=b.appendChild(d),e=0,b=function(b,c,m,r){var g=document.createElement("li");g.className="wmd-button";g.style.left=e+"px";e+=25;var k=document.createElement("span");g.id=b+a;g.appendChild(k);g.title=c;g.XShift=m;r&&(g.textOp=r);s(g,!0);d.appendChild(g);return g},h=function(b){var c=document.createElement("li");c.className="wmd-spacer wmd-spacer"+
b;c.id="wmd-spacer"+b+a;d.appendChild(c);e+=25};f=b("wmd-bold-button",k("bold"),"0px",q("doBold"));D=b("wmd-italic-button",k("italic"),"-20px",q("doItalic"));h(1);m=b("wmd-link-button",k("link"),"-40px",q(function(a,b){return this.doLinkOrImage(a,b,!1)}));r=b("wmd-quote-button",k("quote"),"-60px",q("doBlockquote"));A=b("wmd-code-button",k("code"),"-80px",q("doCode"));z=b("wmd-image-button",k("image"),"-100px",q(function(a,b){return this.doLinkOrImage(a,b,!0)}));h(2);F=b("wmd-olist-button",k("olist"),
"-120px",q(function(a,b){this.doList(a,b,!0)}));G=b("wmd-ulist-button",k("ulist"),"-140px",q(function(a,b){this.doList(a,b,!1)}));v=b("wmd-heading-button",k("heading"),"-160px",q("doHeading"));p=b("wmd-hr-button",k("hr"),"-180px",q("doHorizontalRule"));h(3);o=b("wmd-undo-button",k("undo"),"-200px",null);o.execute=function(a){a&&a.undo()};h=/win/.test(E.platform.toLowerCase())?k("redo"):k("redomac");l=b("wmd-redo-button",h,"-220px",null);l.execute=function(a){a&&a.redo()};g&&(b=document.createElement("li"),
h=document.createElement("span"),b.appendChild(h),b.className="wmd-button wmd-help-button",b.id="wmd-help-button"+a,b.XShift="-240px",b.isHelp=!0,b.style.right="0px",b.title=k("help"),b.onclick=g.handler,s(b,!0),d.appendChild(b));u()})();var w="keydown";x&&(w="keypress");i.addEvent(y,w,function(a){if((a.ctrlKey||a.metaKey)&&!a.altKey&&!a.shiftKey){switch(String.fromCharCode(a.charCode||a.keyCode).toLowerCase()){case "b":j(f);break;case "i":j(D);break;case "l":j(m);break;case "q":j(r);break;case "k":j(A);
break;case "g":j(z);break;case "o":j(F);break;case "u":j(G);break;case "h":j(v);break;case "r":j(p);break;case "y":j(l);break;case "z":a.shiftKey?j(l):j(o);break;default:return}a.preventDefault&&a.preventDefault();window.event&&(window.event.returnValue=!1)}});i.addEvent(y,"keyup",function(a){if(a.shiftKey&&!a.ctrlKey&&!a.metaKey&&13===(a.charCode||a.keyCode))a={},a.textOp=q("doAutoindent"),j(a)});n&&i.addEvent(y,"keydown",function(a){if(27===a.keyCode)return!1});this.setUndoRedoButtonStates=u}function C(a,
c){this.hooks=a;this.getString=c}function y(a){return a.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(a,e,b){e=e.replace(/\?.*$/,function(a){return a.replace(/\+/g," ")});e=decodeURIComponent(e);e=encodeURI(e).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");e=e.replace(/\?.*$/,function(a){return a.replace(/\+/g,"%2b")});b&&(b=b.trim?b.trim():b.replace(/^\s*/,"").replace(/\s*$/,""),b=b.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,
"&gt;"));return b?e+' "'+b+'"':e})}var i={},p={},B={},h=window.document,w=window.RegExp,E=window.navigator;n=/msie/.test(E.userAgent.toLowerCase());q=/msie 6/.test(E.userAgent.toLowerCase())||/msie 5/.test(E.userAgent.toLowerCase());x=/opera/.test(E.userAgent.toLowerCase());var f={bold:"Strong <strong> Ctrl+B",boldexample:"strong text",italic:"Emphasis <em> Ctrl+I",italicexample:"emphasized text",link:"Hyperlink <a> Ctrl+L",linkdescription:"enter link description here",linkdialog:'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',
quote:"Blockquote <blockquote> Ctrl+Q",quoteexample:"Blockquote",code:"Code Sample <pre><code> Ctrl+K",codeexample:"enter code here",image:"Image <img> Ctrl+G",imagedescription:"enter image description here",imagedialog:"<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg \"optional title\"<br><br>Need <a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>free image hosting?</a></p>",olist:"Numbered List <ol> Ctrl+O",ulist:"Bulleted List <ul> Ctrl+U",litem:"List item",
heading:"Heading <h1>/<h2> Ctrl+H",headingexample:"Heading",hr:"Horizontal Rule <hr> Ctrl+R",undo:"Undo - Ctrl+Z",redo:"Redo - Ctrl+Y",redomac:"Redo - Ctrl+Shift+Z",help:"Markdown Editing Help"};Markdown.Editor=function(a,c,e){e=e||{};"function"===typeof e.handler&&(e={helpButton:e});e.strings=e.strings||{};e.helpButton&&(e.strings.help=e.strings.help||e.helpButton.title);var b=function(a){return e.strings[a]||f[a]},c=c||"",d=this.hooks=new Markdown.HookCollection;d.addNoop("onPreviewRefresh");d.addNoop("postBlockquoteCreation");
d.addFalse("insertImageDialog");this.getConverter=function(){return a};var g=this,k;this.run=function(){if(!k){k=new l(c);var f=new C(d,b),D=new s(a,k,function(){d.onPreviewRefresh()}),m,r;/\?noundo/.test(h.location.href)||(m=new o(function(){D.refresh();r&&r.setUndoRedoButtonStates()},k),this.textOperation=function(a){m.setCommandMode();a();g.refreshPreview()});r=new j(c,k,m,D,f,e.helpButton,b);r.setUndoRedoButtonStates();(g.refreshPreview=function(){D.refresh(!0)})()}}};u.prototype.findTags=function(a,
c){var e=this,b;a&&(b=i.extendRegExp(a,"","$"),this.before=this.before.replace(b,function(a){e.startTag+=a;return""}),b=i.extendRegExp(a,"^",""),this.selection=this.selection.replace(b,function(a){e.startTag+=a;return""}));c&&(b=i.extendRegExp(c,"","$"),this.selection=this.selection.replace(b,function(a){e.endTag=a+e.endTag;return""}),b=i.extendRegExp(c,"^",""),this.after=this.after.replace(b,function(a){e.endTag=a+e.endTag;return""}))};u.prototype.trimWhitespace=function(a){var c,e=this;a?a=c="":
(a=function(a){e.before+=a;return""},c=function(a){e.after=a+e.after;return""});this.selection=this.selection.replace(/^(\s*)/,a).replace(/(\s*)$/,c)};u.prototype.skipLines=function(a,c,e){void 0===a&&(a=1);void 0===c&&(c=1);a++;c++;var b,d;navigator.userAgent.match(/Chrome/)&&"X".match(/()./);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag+=w.$1;this.selection=this.selection.replace(/(\n*$)/,"");this.endTag+=w.$1;this.startTag=this.startTag.replace(/(^\n*)/,"");this.before+=w.$1;
this.endTag=this.endTag.replace(/(\n*$)/,"");this.after+=w.$1;if(this.before){for(b=d="";a--;)b+="\\n?",d+="\n";e&&(b="\\n*");this.before=this.before.replace(new w(b+"$",""),d)}if(this.after){for(b=d="";c--;)b+="\\n?",d+="\n";e&&(b="\\n*");this.after=this.after.replace(new w(b,""),d)}};i.isVisible=function(a){if(window.getComputedStyle)return"none"!==window.getComputedStyle(a,null).getPropertyValue("display");if(a.currentStyle)return"none"!==a.currentStyle.display};i.addEvent=function(a,c,e){a.attachEvent?
a.attachEvent("on"+c,e):a.addEventListener(c,e,!1)};i.removeEvent=function(a,c,e){a.detachEvent?a.detachEvent("on"+c,e):a.removeEventListener(c,e,!1)};i.fixEolChars=function(a){a=a.replace(/\r\n/g,"\n");return a=a.replace(/\r/g,"\n")};i.extendRegExp=function(a,c,e){if(null===c||void 0===c)c="";if(null===e||void 0===e)e="";var a=a.toString(),b,a=a.replace(/\/([gim]*)$/,function(a,e){b=e;return""}),a=a.replace(/(^\/|\/$)/g,"");return new w(c+a+e,b)};p.getTop=function(a,c){var e=a.offsetTop;if(!c)for(;a=
a.offsetParent;)e+=a.offsetTop;return e};p.getHeight=function(a){return a.offsetHeight||a.scrollHeight};p.getWidth=function(a){return a.offsetWidth||a.scrollWidth};p.getPageSize=function(){var a,c,e,b;self.innerHeight&&self.scrollMaxY?(a=h.body.scrollWidth,c=self.innerHeight+self.scrollMaxY):h.body.scrollHeight>h.body.offsetHeight?(a=h.body.scrollWidth,c=h.body.scrollHeight):(a=h.body.offsetWidth,c=h.body.offsetHeight);self.innerHeight?(e=self.innerWidth,b=self.innerHeight):h.documentElement&&h.documentElement.clientHeight?
(e=h.documentElement.clientWidth,b=h.documentElement.clientHeight):h.body&&(e=h.body.clientWidth,b=h.body.clientHeight);a=Math.max(a,e);c=Math.max(c,b);return[a,c,e,b]};B.createBackground=function(){var a=h.createElement("div"),c=a.style;a.className="wmd-prompt-background";c.position="absolute";c.top="0";c.zIndex="1000";n?c.filter="alpha(opacity=50)":c.opacity="0.5";var e=p.getPageSize();c.height=e[1]+"px";n?(c.left=h.documentElement.scrollLeft,c.width=h.documentElement.clientWidth):(c.left="0",c.width=
"100%");h.body.appendChild(a);return a};B.prompt=function(a,c,e){var b,d;void 0===c&&(c="");var g=function(a){27===(a.charCode||a.keyCode)&&k(!0)},k=function(a){i.removeEvent(h.body,"keydown",g);var c=d.value;a?c=null:(c=c.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(c)||(c="http://"+c));b.parentNode.removeChild(b);e(c);return!1},f=function(){b=h.createElement("div");b.className="wmd-prompt-dialog";b.style.padding="10px;";b.style.position="fixed";b.style.width="400px";
b.style.zIndex="1001";var e=h.createElement("div");e.innerHTML=a;e.style.padding="5px";b.appendChild(e);var e=h.createElement("form"),m=e.style;e.onsubmit=function(){return k(!1)};m.padding="0";m.margin="0";m.cssFloat="left";m.width="100%";m.textAlign="center";m.position="relative";b.appendChild(e);d=h.createElement("input");d.type="text";d.value=c;m=d.style;m.display="block";m.width="80%";m.marginLeft=m.marginRight="auto";e.appendChild(d);var r=h.createElement("input");r.type="button";r.onclick=
function(){return k(!1)};r.value="OK";m=r.style;m.margin="10px";m.display="inline";m.width="7em";var f=h.createElement("input");f.type="button";f.onclick=function(){return k(!0)};f.value="Cancel";m=f.style;m.margin="10px";m.display="inline";m.width="7em";e.appendChild(r);e.appendChild(f);i.addEvent(h.body,"keydown",g);b.style.top="50%";b.style.left="50%";b.style.display="block";q&&(b.style.position="absolute",b.style.top=h.documentElement.scrollTop+200+"px",b.style.left="50%");h.body.appendChild(b);
b.style.marginTop=-(p.getHeight(b)/2)+"px";b.style.marginLeft=-(p.getWidth(b)/2)+"px"};setTimeout(function(){f();var a=c.length;if(void 0!==d.selectionStart)d.selectionStart=0,d.selectionEnd=a;else if(d.createTextRange){var b=d.createTextRange();b.collapse(!1);b.moveStart("character",-a);b.moveEnd("character",a);b.select()}d.focus()},0)};var v=C.prototype;v.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";v.unwrap=function(a){var c=new w("([^\\n])\\n(?!(\\n|"+
this.prefixes+"))","g");a.selection=a.selection.replace(c,"$1 $2")};v.wrap=function(a,c){this.unwrap(a);var e=new w("(.{1,"+c+"})( +|$\\n?)","gm"),b=this;a.selection=a.selection.replace(e,function(a,e){return(new w("^"+b.prefixes,"")).test(a)?a:e+"\n"});a.selection=a.selection.replace(/\s+$/,"")};v.doBold=function(a,c){return this.doBorI(a,c,2,this.getString("boldexample"))};v.doItalic=function(a,c){return this.doBorI(a,c,1,this.getString("italicexample"))};v.doBorI=function(a,c,e,b){a.trimWhitespace();
a.selection=a.selection.replace(/\n{2,}/g,"\n");var d=/(\**$)/.exec(a.before)[0],c=/(^\**)/.exec(a.after)[0],d=Math.min(d.length,c.length);d>=e&&(2!=d||1!=e)?(a.before=a.before.replace(w("[*]{"+e+"}$",""),""),a.after=a.after.replace(w("^[*]{"+e+"}",""),"")):!a.selection&&c?(a.after=a.after.replace(/^([*_]*)/,""),a.before=a.before.replace(/(\s?)$/,""),a.before=a.before+c+w.$1):(!a.selection&&!c&&(a.selection=b),e=1>=e?"*":"**",a.before+=e,a.after=e+a.after)};v.stripLinkDefs=function(a,c){return a=
a.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(a,b,d,g,k){c[b]=a.replace(/\s*$/,"");return g?(c[b]=a.replace(/["(](.+?)[")]$/,""),g+k):""})};v.addLinkDef=function(a,c){var e=0,b={};a.before=this.stripLinkDefs(a.before,b);a.selection=this.stripLinkDefs(a.selection,b);a.after=this.stripLinkDefs(a.after,b);var d="",g=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,k=function(a){e++;a=a.replace(/^[ ]{0,3}\[(\d+)\]:/,
"  ["+e+"]:");d+="\n"+a},f=function(a,d,c,h,j,i){c=c.replace(g,f);return b[j]?(k(b[j]),d+c+h+e+i):a};a.before=a.before.replace(g,f);c?k(c):a.selection=a.selection.replace(g,f);var h=e;a.after=a.after.replace(g,f);a.after&&(a.after=a.after.replace(/\n*$/,""));a.after||(a.selection=a.selection.replace(/\n*$/,""));a.after+="\n\n"+d;return h};v.doLinkOrImage=function(a,c,e){a.trimWhitespace();a.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var b;if(1<a.endTag.length&&0<a.startTag.length)a.startTag=
a.startTag.replace(/!?\[/,""),a.endTag="",this.addLinkDef(a,null);else if(a.selection=a.startTag+a.selection+a.endTag,a.startTag=a.endTag="",/\n\n/.test(a.selection))this.addLinkDef(a,null);else{var d=this,g=function(g){b.parentNode.removeChild(b);null!==g&&(a.selection=(" "+a.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1),g=" [999]: "+y(g),g=d.addLinkDef(a,g),a.startTag=e?"![":"[",a.endTag="]["+g+"]",a.selection||(a.selection=e?d.getString("imagedescription"):d.getString("linkdescription")));
c()};b=B.createBackground();e?this.hooks.insertImageDialog(g)||B.prompt(this.getString("imagedialog"),"http://",g):B.prompt(this.getString("linkdialog"),"http://",g);return!0}};v.doAutoindent=function(a){var c=!1;a.before=a.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");!a.selection&&!/^[ \t]*(?:\n|$)/.test(a.after)&&(a.after=a.after.replace(/^[^\n]*/,function(e){a.selection=
e;return""}),c=!0);/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(a.before)&&this.doList&&this.doList(a);/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(a.before)&&this.doBlockquote&&this.doBlockquote(a);/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&this.doCode&&this.doCode(a);c&&(a.after=a.selection+a.after,a.selection="")};v.doBlockquote=function(a){a.selection=a.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(b,d,e,c){a.before+=d;a.after=c+a.after;return e});a.before=a.before.replace(/(>[ \t]*)$/,function(b,
d){a.selection=d+a.selection;return""});a.selection=a.selection.replace(/^(\s|>)+$/,"");a.selection=a.selection||this.getString("quoteexample");var c="",e="",b;if(a.before){for(var d=a.before.replace(/\n$/,"").split("\n"),g=!1,k=0;k<d.length;k++){var f=!1;b=d[k];g=g&&0<b.length;/^>/.test(b)?(f=!0,!g&&1<b.length&&(g=!0)):f=/^[ \t]*$/.test(b)?!0:g;f?c+=b+"\n":(e+=c+b,c="\n")}/(^|\n)>/.test(c)||(e+=c,c="")}a.startTag=c;a.before=e;a.after&&(a.after=a.after.replace(/^\n?/,"\n"));a.after=a.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,
function(b){a.endTag=b;return""});c=function(b){var d=b?"> ":"";a.startTag&&(a.startTag=a.startTag.replace(/\n((>|\s)*)\n$/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,d)+"\n"}));a.endTag&&(a.endTag=a.endTag.replace(/^\n((>|\s)*)\n/,function(a,b){return"\n"+b.replace(/^[ ]{0,3}>?[ \t]*$/gm,d)+"\n"}))};/^(?![ ]{0,3}>)/m.test(a.selection)?(this.wrap(a,70),a.selection=a.selection.replace(/^/gm,"> "),c(!0),a.skipLines()):(a.selection=a.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(a),
c(!1),!/^(\n|^)[ ]{0,3}>/.test(a.selection)&&a.startTag&&(a.startTag=a.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(a.selection)&&a.endTag&&(a.endTag=a.endTag.replace(/^\n{0,2}/,"\n\n")));a.selection=this.hooks.postBlockquoteCreation(a.selection);/\n/.test(a.selection)||(a.selection=a.selection.replace(/^(> *)/,function(b,d){a.startTag+=d;return""}))};v.doCode=function(a){var c=/\S[ ]*$/.test(a.before);if(!/^[ ]*\S/.test(a.after)&&!c||/\n/.test(a.selection)){a.before=a.before.replace(/[ ]{4}$/,
function(b){a.selection=b+a.selection;return""});var e=c=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&(c=0);/^\n(\t|[ ]{4,})/.test(a.after)&&(e=0);a.skipLines(c,e);a.selection?/^[ ]{0,3}\S/m.test(a.selection)?/\n/.test(a.selection)?a.selection=a.selection.replace(/^/gm,"    "):a.before+="    ":a.selection=a.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,""):(a.startTag="    ",a.selection=this.getString("codeexample"))}else a.trimWhitespace(),a.findTags(/`/,/`/),!a.startTag&&!a.endTag?(a.startTag=a.endTag=
"`",a.selection||(a.selection=this.getString("codeexample"))):a.endTag&&!a.startTag?(a.before+=a.endTag,a.endTag=""):a.startTag=a.endTag=""};v.doList=function(a,c,e){var c=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,b="-",d=1,g=function(){var a;e?(a=" "+d+". ",d++):a=" "+b+" ";return a},k=function(a){void 0===e&&(e=/^\s*\d/.test(a));return a=a.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return g()})};a.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,
null);a.before&&!/\n$/.test(a.before)&&!/^\n/.test(a.startTag)&&(a.before+=a.startTag,a.startTag="");if(a.startTag){var f=/\d+[.]/.test(a.startTag);a.startTag="";a.selection=a.selection.replace(/\n[ ]{4}/g,"\n");this.unwrap(a);a.skipLines();f&&(a.after=a.after.replace(c,k));if(e==f)return}var h=1;a.before=a.before.replace(/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,function(a){/^\s*([*+-])/.test(a)&&(b=w.$1);h=/[^\n]\n\n[^\n]/.test(a)?1:0;
return k(a)});a.selection||(a.selection=this.getString("litem"));var f=g(),m=1;a.after=a.after.replace(c,function(a){m=/[^\n]\n\n[^\n]/.test(a)?1:0;return k(a)});a.trimWhitespace(!0);a.skipLines(h,m,!0);a.startTag=f;c=f.replace(/./g," ");this.wrap(a,72-c.length);a.selection=a.selection.replace(/\n/g,"\n"+c)};v.doHeading=function(a){a.selection=a.selection.replace(/\s+/g," ");a.selection=a.selection.replace(/(^\s+|\s+$)/g,"");if(a.selection){var c=0;a.findTags(/#+[ ]*/,/[ ]*#+/);/#+/.test(a.startTag)&&
(c=w.lastMatch.length);a.startTag=a.endTag="";a.findTags(null,/\s?(-+|=+)/);/=+/.test(a.endTag)&&(c=1);/-+/.test(a.endTag)&&(c=2);a.startTag=a.endTag="";a.skipLines(1,1);c=0==c?2:c-1;if(0<c){var c=2<=c?"-":"=",e=a.selection.length;72<e&&(e=72);for(a.endTag="\n";e--;)a.endTag+=c}}else a.startTag="## ",a.selection=this.getString("headingexample"),a.endTag=" ##"};v.doHorizontalRule=function(a){a.startTag="----------\n";a.selection="";a.skipLines(2,1,!0)}})();
(function(){function n(){for(var a=0;a<w.length;a++)w[a].refreshPreview()}function x(a){var b=a.match(/^\s*>\s*!/mg);if(b&&b.length==a.split("\n").length){var d=!1,a=a.replace(/(.*) (\w)/,function(a,b,e){d=!0;return b+"\n> "+e});d||(a=a.replace(/^(\s*>\s*)!/m,"$1&#33;"))}return a}function q(a){var b=/^\s*?[^\s!]/m,d=/^\s*?!/gm;return a=a.replace(/\<blockquote\>[\n\s]*?\<p\>[\n\s]*?(![\s\S]*?)\<\/p\>[\n\s]*?\<\/blockquote\>/g,function(a,e){if(b.test(e))return a;a=a.replace(e,e.replace(d,""));return a=
a.replace("<blockquote>",'<blockquote class="spoiler">')})}function u(a){if(!window.tagRendererRaw)return a;var b,d;return a=a.replace(/\[(meta-)?tag:([a-z0-9#+.-]+)\]/gi,function(e,c,g,k){if(!h&&c)return e;if(!b){for(var f=a,j=[],i=/<(a|code)[^>]*>/ig,l;null!=(l=i.exec(f));){j.push(l.index);l=RegExp("</"+l[1]+">","ig");l.lastIndex=i.lastIndex;if(null==l.exec(f))break;j.push(l.lastIndex);i.lastIndex=l.lastIndex}b=j;d=b.length}f=!1;for(j=0;j<d&&!(b[j]>k);j++)f=!f;if(f)return e;e=null;h&&!c&&(e=B);
return tagRendererRaw(sanitizeAndSplitTags(g)[0],e)})}function l(a){var b,d;"undefined"==typeof v&&(v=StackExchange.options.styleCode);v&&(b=j(a),d=j(b+a),a=y(a,b,d));a=o(a);v&&(a=i(a,b,d));return a}function o(a){return a.replace(/<[^>]*>?/gi,t)}function t(b){return b.match(a)||b.match(c)||b.match(e)?b:""}function s(a){if(""==a)return"";var b=/<\/?\w+[^>]*(\s|$|>)/g,d=a.toLowerCase().match(b),e=(d||[]).length;if(0==e)return a;for(var c,g,f,k=[],h=[],j=!1,i=0;i<e;i++)if(c=d[i].replace(/<\/?(\w+).*/,
"$1"),!(k[i]||-1<"<p><img><br><li><hr>".search("<"+c+">"))){g=d[i];f=-1;if(!/^<\//.test(g))for(g=i+1;g<e;g++)if(!k[g]&&d[g]=="</"+c+">"){f=g;break}-1==f?j=h[i]=!0:k[f]=!0}if(!j)return a;i=0;return a=a.replace(b,function(a){a=h[i]?"":a;i++;return a})}function j(a){a=(a.match(/~/g)||[]).length;return Array(a+2).join("~")}function C(a){if(/^lang-/.test(a))return a;var e="c_"+a,c=b[e];if(c)return c;if(d[e])return null;d[e]=!0;e=g.length;0<e&&RegExp("^"+g[e-1]).test(a)?g[e-1]=a:g.push(a);k.trigger();return null}
function y(a,b,d){a=a.replace(I,function(a,d,e){return b+d+b+e});return a.replace(D,function(a,b){return d+b+d})}function i(a,b,d){var a=a.replace(RegExp(b+"([a-z0-9#+.-]+)"+b+"(\\s*?<pre)","gi"),function(a,b,d){a=C(b);return!a?d:d+" class='"+a+" prettyprint-override'"}),e;return a.replace(RegExp("("+d+"([a-z0-9#+.-]+)"+d+")|(<pre><code>)","gi"),function(a,b,d){if(b)return e=d,"";if(!e)return a;b=C(e);return!b?a:"<pre class='"+b+" prettyprint-override'><code>"})}function p(a){function b(){c.animate({height:g.height()-
f})}function d(a){if(g)a();else if(!i){i=!0;var e=l.offset();f=e.top-$("#wmd-button-row"+j).offset().top-$("#wmd-button-row"+j).outerHeight()-5;k=$("#wmd-help-button"+j);var m=k.offset().left+k.outerWidth(),e=e.left,o=l.outerWidth()+e,o=Math.max(m,o);h={right:m-o,width:o-e,top:$("#wmd-button-row"+j).outerHeight()+5};k.addClass("active-help");c=$("<div style='clear:both' />").insertBefore(l);g=$('<div id="mdhelp'+j+'" class="mdhelp"><ul id="mdhelp-tabs'+j+'" class="mdhelp-tabs"><li /></ul></div>').find("li").addSpinner().end().css(h).insertAfter(k);
b();$.get("/posts/markdown-help",{postfix:j}).done(function(d){g.remove();g=$(d).insertAfter(k).css(h);$("#mdhelp-tabs"+j).delegate("li:not(:last-child)","click",function(){var a=$(this).hasClass("selected");g.find(".mdhelp-tab").hide();$("#mdhelp-tabs"+j+" li").removeClass("selected");if(!a&&($("#"+$(this).attr("data-tab")).show(),$(this).addClass("selected"),a=$(this).attr("data-buttons")))for(var a=a.split(","),d=0;d<a.length;d++){var e=$("#wmd-"+a[d]+"-button"+j);e.is(":animated")||e.animate({top:-15},
400).animate({top:0},400).animate({top:-8},300).animate({top:0},300).animate({top:-4},200).animate({top:0},200).animate({top:-2},100).animate({top:0},100).animate({top:-1},50).animate({top:0},50)}b()});i=!1;a()})}}function e(){o=!0;d(function(){k.addClass("active-help");g.show();b()})}var c,g,f,k,h,i=!1,j=(a||{}).postfix||"",l=$("#wmd-input"+j),o=!1;this.toggle=function(){g&&g.is(":visible")?(g.hide(),c.animate({height:0}),k.removeClass("active-help")):e()};this.showOnce=function(){o||e()}}if(!StackExchange.MarkdownEditor){var B,
h,w=[],E=function(a){function b(a){return"facebook.stackoverflow.com"===a?"stackoverflow.com":a}function d(b){window.apiCallbacks[b]||(window.apiCallbacks[b]=function(d){if(d)if(d.error_message)/^No site found/.test(d.error_message)&&(l["s_"+b]=!0);else if(d.items){for(var d=d.items,e=d.length,c=0;c<e;c++){var g=d[c];f[b+"|"+g.question_id]=g.title}a&&a()}});return'apiCallbacks["'+b+'"]'}function e(a,d){if(b(a)===k)return!0;var c=o[a];c||(c=o[a]={count:0,ids:{}});if(c.ids[d])return!0;if(c.count>=v)return!1;
c.count++;return c.ids[d]=!0}var c=/<a href="((\S+)\/q(?:uestions)?\/(\d+)(?:|\/\S*?))">\1<\/a>/g,g=window.location.hostname.toLowerCase(),k=b(g),f={},j={},h={},i=StackExchange.helpers.DelayedReaction(function(){var a=!1,e;for(e in h)if(h.hasOwnProperty(e)){var c=d(e),g;30<h[e].length?g=h[e].splice(0,30).join(";"):(g=h[e].join(";"),delete h[e]);a=!0;$.ajax({url:"http://api.stackexchange.com/2.0/questions/"+g+"?pagesize=30&key=6AU78DZ)GcdjNjAszYmTLQ((&filter=!6G7RPxWUNTleV&site="+b(e),crossDomain:!0,
jsonpCallback:c,dataType:"jsonp"});break}a&&i.trigger()},1E3,{sliding:!0}),l={};window.apiCallbacks={};var o={},v=/^meta\./.test(k)?40:10;return function(a){o={};return a.replace(c,function(a,d,c,g){c=c.toLowerCase().replace(/^http:\/\//,"");if(/[^a-z0-9.]/.test(c)||!e(c,g))return a;var m=f[c+"|"+g];if(m)g=m;else{if(m=!j[c+"|"+g]){m=b(c);if(m===k)m=!1;else if(l["s_"+m])m=!0;else var o=/^meta\./.test(k),m=k==="meta."+m||!o&&"meta."+k===m||o&&"meta.stackoverflow.com"==m||"meta.stackoverflow.com"===
k?!1:!0;m=!m}m&&(j[c+"|"+g]=!0,(m=h[c])||(m=h[c]=[]),m.push(g),i.trigger());g=null}return!g?a:'<a href="'+d+'">'+g+"</a>"})}}(n),f=$.Callbacks();StackExchange.MarkdownEditor=function(a){var b=a.postfix||"";B=$("#hlinks a").filter(function(){return"main"==$(this).text()}).attr("href");h=!!B;var d=new Markdown.Converter,e=d.hooks;e.addNoop("preSafe");e.chain("postConversion",E);e.chain("postConversion",function(a){return e.preSafe(a)});e.chain("postConversion",l);e.chain("postConversion",s);e.chain("postConversion",
q);e.chain("postConversion",u);var c=new p({postfix:b}),g={helpButton:{handler:c.toggle}};a.noCode&&(g.strings={code:"Preformatted text <pre><code> Ctrl-K",codeexample:"enter preformatted text here"});d=new Markdown.Editor(d,b,g);d.hooks.chain("postBlockquoteCreation",x);StackExchange.options.disableImageUploads||d.hooks.set("insertImageDialog",StackExchange.imageUploader.uploadImageDialog);f.fire(d,a.postfix);var k=$("#wmd-preview"+b);d.hooks.chain("onPreviewRefresh",function(){k.trigger("wmdrefresh")});
w.push(d);d.run();if(a.immediatelyShowMarkdownHelp)c.showOnce(a);else if(a.autoShowMarkdownHelp)$("#wmd-input"+b).one("focus",function(){c.showOnce(a)});d.disableSubmission=function(){$("#submit-button"+b).attr("disabled","disabled");StackExchange.navPrevention.stop()};return d};StackExchange.MarkdownEditor.creationCallbacks=f;StackExchange.MarkdownEditor.refreshAllPreviews=n;var v;StackExchange.MarkdownEditor.sanitizeHtml=o;var a=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,
c=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,e=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;StackExchange.MarkdownEditor.balanceTags=s;var b={},d={},g=[],k=StackExchange.helpers.DelayedReaction(function(){0!=g.length&&($.ajax("/api/tags/"+encodeURIComponent(g.join(";"))+"/syntax-highlight",{cache:!0}).done(function(a){var d=!1,
e;for(e in a)a.hasOwnProperty(e)&&(b["c_"+e]=a[e],d=!0);d&&(StackExchange.MarkdownEditor.refreshAllPreviews(),styleCode())}),g=[])},2E3,{sliding:!0}),I=/<\!-- language: ([a-z0-9#+\-.]+) --\>(\s*?<pre>\s*?<code>)/gi,D=/<\!-- language-all: ([a-z0-9#+\-.]+) --\>/gi}})();
StackExchange.editor=function(){var n=function(n){var n=n||{},q=n.postfix||"",u=n.heartbeatType,l=n.bindNavPrevention,o=$("#post-form"+q),t=$("#wmd-input"+q),s;s=$("#title, #edit-comment, #m-address, .edit-comment");q=s.add(".tag-editor input");o.submit(function(){s.each(function(){StackExchange.helpers.hideHelpOverlay($(this))});StackExchange.helpers.disableSubmitButton(o);StackExchange.navPrevention.stop();return!0});$(".original-question").not(".processed").TextAreaResizer();t.not(".processed").TextAreaResizer();
t.typeWatch({highlight:!1,wait:5E3,captureLength:5,callback:styleCode});var j=new StackExchange.MarkdownEditor(n);if(u){var C=n.discardSelector?$(n.discardSelector):null;StackExchange.cardiologist.addHeart(u,t,j,C,n.postId)}if("ask"==u||"answer"==u){var y=t.add(q),i=function(){StackExchange.helpers.loadTicks(o);y.unbind("keydown",i);return!0};y.bind("keydown",i)}l&&StackExchange.navPrevention.init(t);o.find(".wmd-preview").click(function(){$(this).siblings().find("textarea").focus()});StackExchange.helpers.bindHelpOverlayEvents(s);
0==$("#ask-page-has-errors").length&&$("#title").is("input")&&$("#title").focus();if(n.oncreated)n.oncreated(j);if(n.discardSelector&&("ask"==u||"answer"==u)){var p=$(n.discardSelector);p.click(function(i){i.preventDefault();confirm("Are you sure you want to discard your draft?")&&($("#title").val("").blur(),$("#question-suggestions").empty(),$("#wmd-input-42").val(""),$("#wmd-preview-42").html(""),$("#answer-from-ask").is(":visible")&&$("#answer-from-ask").is(":checked")&&$("#answer-from-ask").click(),
i=$("#tagnames"),0<i.length&&i[0].func_clear&&(i[0].func_clear(),i.blur()),t.val("").blur(),j.refreshPreview(),$.post("/post/discard-draft",{fkey:StackExchange.options.user.fkey,postType:u},function(){$("#draft-saved").hide();$("#draft-discarded").show();var h=null,h=function(){$("#draft-discarded").hide();$("#title").unbind("keypress",h);t.unbind("keypress",h)};$("#title").bind("keypress",h);t.bind("keypress",h)}),p.hide())})}};return{init:n,initIfShown:function(x){var q=(x||{}).postfix||"";0!=$("#wmd-preview"+
q).length&&("-42"!==q||0===$("#answer-from-ask").length)&&0===$("#show-editor-button"+q).length?(n(x),StackExchange.editor.finallyInit||(StackExchange.editor.finallyInit=function(){})):StackExchange.editor.finallyInit=function(){n(x)}}}}();
StackExchange.cardiologist=function(){function n(f){f="number"===typeof f?f:1E3*(C+y);B&&(f=Math.max(f,6E3-((new Date).getTime()-B)));h&&clearTimeout(h);h=setTimeout(x,f)}function x(){h=null;if(!t.length){var f;t=[];o&&!o.isDisabled&&30>o.beatCount&&t.push(o);for(var i=0;i<l.length;i++)f=l[i],f!=o&&!f.isDisabled&&30>f.beatCount&&t.push(f);C=Math.max(15,Math.min(45,60/(t.length||1)))}t.length?(f=t.shift(),f.checkActive()?f.beat():n()):n()}function q(){}function u(f){var h=[];$.get("/questions/"+f,
function(a){a=$(a);a.find("div.answer").each(function(){var a=this.id.substring(7);0==$("#answer-"+a).length&&h.push(this.id)});if(0<h.length){var c="#"+h.join(",#"),a=a.find(c),c=$("div.answer:last");0==c.length&&(c=$("#answers-header"));a.hide();c.after(a);a.fadeIn("slow");c=$("div.answer").length;$(".subheader h2").text(c+" Answer"+(1<c?"s":""));StackExchange.vote.init(f);StackExchange.comments.init({post:a})}StackExchange.notify.close(p);i=!1},"html")}var l=[],o,t=[],s,j,C=45,y=0,i=!1,p=-2,B,
h,w={ask:function(f){if(f.relatedQuestions){var h=$("#how-to-format"),a=f.relatedQuestions!=j;a&&h.hide();h.empty().append("<h4>Similar Questions</h4>"+f.relatedQuestions);a&&showFadingHelpText(h);j=f.relatedQuestions}f.suggestedTags&&StackExchange.tagSuggestions&&StackExchange.tagSuggestions.suggest(f.suggestedTags)},answer:function(f,h){if(f&&!i)if(f.disableEditor)StackExchange.notify.show("This question has been "+f.message+" - no more answers will be accepted.",p),i=!0;else{var a=parseInt(f.message);
0<a&&(StackExchange.notify.show(a+" new answer"+(1==a?" has":"s have")+' been posted - <a id="load-new-answers">load new answers.</a>',p),i=!0,$("#load-new-answers").click(function(){u(h.postId)}))}},edit:function(f){f&&f.message&&StackExchange.notify.getMessageText(p)!=$("<span />").html(f.message).text()&&(StackExchange.notify.close(p),StackExchange.notify.show(f.message,p))}};q.prototype={activate:function(){o=this;this.isActive||(this.isActive=!0,this.beatCount=0,l.push(this),1===l.length&&n())},
checkActive:function(){if(!this.isActive||this.isDisabled)return!1;return!this.jTextarea.closest("body").length?(delete this.jTextarea,this.isDisabled=!0,!1):!0},beat:function(f){var h=this,a={type:"POST",url:"/posts/"+this.postId+"/editor-heartbeat/"+this.type,dataType:"json",data:{}};f||(a.success=function(a){h.success(a)},a.error=function(){h.error()},a.complete=function(){h.complete()});if(this.shouldSendDraft()){var c={text:this.jTextarea.val()};"ask"===this.type&&(c.title=$("#title").val(),
c.tagnames=$("#tagnames").val(),c.answertext=$("#wmd-input-42").val());if(!s||s.heart!==this||s.title!==c.title||s.tagnames!==c.tagnames||s.text!==c.text||s.answertext!==c.answertext)a.data=c,s={heart:this,title:c.title,tagnames:c.tagnames,text:c.text,answertext:c.answertext}}if(f&&!("text"in a.data))return $.Deferred().resolve().promise();this.revisionGuid&&(a.data.clientRevisionGuid=this.revisionGuid);"answer"===this.type&&(f=$("#answers-header .answers-subheader h2").text().replace(/ answers?/i,
"")||"0",a.data.clientCount=f);B=(new Date).getTime();return $.ajax(a).promise()},shouldSendDraft:function(){return"edit"!==this.type&&o===this},success:function(f){w[this.type](f,this);f.disableEditor&&(this.editor.disableSubmission(),this.isDisabled=!0);f.draftSaved&&E(this.jTextarea,this.discardDraftLink);this.beatCount++;y=0},error:function(){$("#draft-saved").hide();o===this&&t.unshift(this);y=(new Date).getTime()%100/10},complete:function(){n()}};var E=function(f,h){var a=$("#draft-saved"),
c=function(){a.text("draft saved").fadeIn("fast")};a.is(":visible")?a.fadeOut("fast",c):c();h&&h.removeClass("dno").show();var e=function(a){if(115!=a.which||!a.ctrlKey||a.shiftKey||a.altKey)f.unbind("keypress",e),$("#draft-saved").fadeOut("fast")};f.bind("keypress",e);$("#draft-discarded").hide()};return{addHeart:function(f,h,a,c,e){var b=new q,d;b.type=f;b.jTextarea=h;b.discardDraftLink=c;switch(f){case "ask":d=0;break;case "answer":d=$("#post-id").val()||location.href.match(/\/questions\/(\d+)/i)[1];
break;case "edit":d=e||$("#post-id").val()||h.closest(".question, .answer").find(".vote input").val(),f=h.closest(".inline-post"),c=null,0<f.length&&(c=f[0].action.split("/").pop()),c||(c=$("#client-revision-guid").val()),b.revisionGuid=c}b.postId=d;b.editor=a;h.keypress(function(){b.activate()})},ensureDraftSaved:function(f,h){!o||!o.checkActive()?f():o.beat(h).done(f)},beatASAP:function(){n(1)},notifiedOfNewAnswer:function(){i=!0},isHeartBeating:function(){if(null==l)return!1;for(var f=0;f<l.length;f++)if(!0==
l[f].checkActive())return!0;return!1}}}();
StackExchange.navPrevention=function(){var n,x,q=function(){var l=!1;n.each(function(n){l=l||$(this).val()!==x[n]});return l},u=function(l){window.onbeforeunload=l?function(){if(n&&q())return l}:null},l=function(){u("You have started writing or editing a post.")};return{init:function(o){n=o.one("keypress",l);x=[];o.each(function(){x.push($(this).val())})},start:function(){n&&l()},stop:function(){n&&(n.unbind("keypress",l),u(null),n=null)},confirm:function(l){return n&&q()?confirm(l):!0}}}();
(function(n){function x(j){l=n(j.data.el);l.blur();t=j.clientY+document.documentElement.scrollTop;o=l.height()-t;l.css("opacity",0.25);n(document).mousemove(q).mouseup(u);return!1}function q(j){var n=j.clientY+document.documentElement.scrollTop,q=o+n;t>=n&&(q-=5);t=n;q=Math.max(s,q);l.height(q+"px");q<s&&u(j);return!1}function u(){n(document).unbind("mousemove",q).unbind("mouseup",u);l.css("opacity",1);l.focus();o=l=null;t=0}var l,o,t=0,s=32;n.fn.TextAreaResizer=function(){return this.each(function(){l=
n(this).addClass("processed");o=null;n(this).parent().append(n('<div class="grippie"></div>').bind("mousedown",{el:this},x));var j=n("div.grippie",n(this).parent())[0];j.style.marginRight=j.offsetWidth-n(this)[0].offsetWidth+"px"})}})(jQuery);"use strict";
StackExchange.imageUploader=function(){return{uploadImageDialog:function(n,x){var q="upload-iframe-"+(new Date).getTime();"undefined"===typeof x&&(x="/upload/image");var u="",l=window.FileReader&&window.FormData,o=l&&"ondrop"in window,t=l&&"onpaste"in document.body&&window.Clipboard;o&&t?u="(or paste or drag-and-drop)":o&&(u="(or drag-and-drop)");var s=$('<div class="popup" id="image-upload" style="z-index:1010; width: 420px;" tabindex="-1"><div class="popup-close"><a title="close this popup (or hit Esc)">&times;</a></div><iframe id="'+
q+'" style="display:none;" src="about:blank" name="'+q+'"/><form action="'+x+'" id="upload-form" method="post" enctype="multipart/form-data"><input type="hidden" name="fkey" value="'+StackExchange.options.user.fkey+'" /><div><h2 style="margin-bottom: 12px; cursor: move;" class="handle">Add Image</h2><input type="radio" name="source" id="computer" checked="checked" value="computer" /> <label for="computer">From my computer</label> <input type="file" name="filename" id="filename-input" value="browse" size="18" style="float: right; width: 250px;" /><div id="url-wrapper" style="float: right; border: 0; padding: 0; margin: 0; display: none;"><input type="text" name="upload-url" id="url-input" style="width: 250px;" /><span class="edit-field-overlay">http://example.com/image.png</span></div><br /><input type="radio" name="source" id="web" value="web" /> <label for="web">From the web</label><br /><br /><p id="upload-message" style="padding-top: 4px; margin:0; line-height: 16px;"></p><span style="position: absolute; margin-top: 10px;">'+
u+'</span><input type="submit" id="add-picture" value="Add picture" style="float: right;" /></div></form></div><script type="text/javascript">    StackExchange.helpers.bindMovablePopups();    StackExchange.helpers.bindHelpOverlayEvents($("#url-input"));<\/script>'),j,C,y,i=function(a){27===(a.charCode||a.keyCode)&&p(null)},p=function(a){s&&s.fadeOutAndRemove();$("body").unbind("keydown",i);$("body").unbind("paste");void 0!==a&&n(a);C&&C.fadeOutAndRemove();return!1},B=function(a){p();C=$('<div class="popup" id="image-upload" style="z-index:1010;"><iframe id="'+
q+'" style="display:none;" src="about:blank" name="'+q+'"/><div class="popup-close"><a title="close this popup (or hit Esc)">&times;</a></div><input type="hidden" name="fkey" value="'+StackExchange.options.user.fkey+'" /><div><h2 style="margin-bottom: 12px; cursor: move;" class="handle">Add a picture</h2><img src="'+a+'" style="max-width: 250px;padding: 5px;" /><br /><p id="upload-message" style="padding-top: 4px; margin:0; line-height: 16px;"><span style="float: right;"><input type="button" id="confirm-upload" value="Confirm" />&nbsp;&nbsp;&nbsp;<a id="cancel-upload">cancel</a></span></div></form></div>    <script type="text/javascript">    StackExchange.helpers.bindMovablePopups();<\/script>');
c(C)},h=function(a){a=a||window.event;a.preventDefault&&a.preventDefault();j.style.backgroundColor="white";y=a.dataTransfer.files[0];a=new window.FileReader;a.onloadend=w;a.readAsDataURL(y);return!1},w=function(a){B(a.target.result)},E=function(a){a=a.originalEvent||window.event;if(a.clipboardData&&(a=a.clipboardData.items))for(var b=0;b<a.length;b++)if(-1!==a[b].type.indexOf("image")){y=a[b].getAsFile();var d=(window.URL||window.webkitURL).createObjectURL(y);B(d)}},f=function(){return!1},v=function(){return!1},
a=function(){C.find("#upload-message").text("Uploading ").addSpinner();if(window.FormData){var a=new window.FormData;a.append("uploadedImage",y);a.append("fkey",StackExchange.options.user.fkey);$.ajax({url:x,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(a){$("#"+q).contents().find("html").html(a)}})}},c=function(){C.appendTo("#header").center().fadeIn("fast");$("body").keydown(i);C.find(".popup-close").click(function(){p(null)});$("#cancel-upload").click(function(){p(null)});
$("#confirm-upload").click(a);window.closeDialog=p;window.displayUploadError=function(a){$("#upload-message").css({color:"red",fontWeight:"bold"}).show().text(a)}};s.appendTo("#header").center().fadeIn("fast").promise().done(function(){j=document.getElementById("image-upload");o&&(j.ondrop=h,j.ondragover=v,j.ondragleave=f);t&&$("body").bind("paste",E);s.find(".popup-close").click(function(){p(null)});s.find(":radio").change(function(){var a=s.find("#filename-input"),b=s.find("#url-wrapper");a.toggle();
b.toggle();b.is(":visible")&&s.find("#url-input").focus()});s.find("form").submit(function(){s.find("#upload-message").text("Uploading ").addSpinner();var a=s.find(":radio:checked").val(),b=s.find("#filename-input"),d=s.find("#url-input"),c;if("web"==a){var k=b.parent(),f=b.next();b.remove();c=function(){k.insertBefore(b,f)}}else{var h=d.parent(),i=d.next();d.remove();c=function(){h.insertBefore(d,i)}}this.target=q;window.closeDialog=p;window.displayUploadError=function(a){$("#upload-message").css({color:"red",
fontWeight:"bold"}).show().text(a);c();c=null};return!0});s.find("#filename-input").focus()});$("body").keydown(i);return!0}}}();
StackExchange.postValidation=function(){function n(a,d,e){var c=a.find('input[type="submit"]:visible'),f=c.length&&c.is(":enabled");f&&c.attr("disabled",!0);q(a);u(a,d,e);o(a);t(a);s(a);var h=function(){1!=d||a.find(E).length?(l(a),f&&c.attr("disabled",!1)):setTimeout(h,250)};h()}function x(){for(var a=0;a<c.length;a++)clearTimeout(c[a]);c=[]}function q(a){var d=a.find(h);d.length&&d.blur(function(){c.push(setTimeout(function(){var e=d.val(),c=$.trim(e);if(0==c.length)p(a,d);else{var f=d.data("min-length");
f&&c.length<f?i(d,["Title must be at least "+f+" characters."],j()):(f=d.data("max-length"))&&c.length>f?i(d,["Title cannot be longer than "+f+" characters."],j()):$.ajax({type:"POST",url:"/posts/validate-title",data:{title:e},success:function(c){c.success?p(a,d):i(d,c.errors.Title,j())},error:function(){p(a,d)}})}},e))})}function u(a,d,g){var f=a.find(w);f.length&&f.blur(function(){c.push(setTimeout(function(){var c=f.val(),e=$.trim(c);0==e.length?p(a,f):5==d?(c=f.data("min-length"))&&e.length<c?
i(f,["Wiki Body must be at least "+c+" characters. You entered "+e.length+"."],j()):p(a,f):(1==d||2==d)&&$.ajax({type:"POST",url:"/posts/validate-body",data:{body:c,oldBody:f.prop("defaultValue"),isQuestion:1==d,isSuggestedEdit:g},success:function(d){d.success?p(a,f):i(f,d.errors.Body,j())},error:function(){p(a,f)}})},e))})}function l(a){var d=a.find(E);if(d.length){var g=d.parent().find("input#tagnames");g.blur(function(){c.push(setTimeout(function(){var c=g.val();0==$.trim(c).length?p(a,d):$.ajax({type:"POST",
url:"/posts/validate-tags",data:{tags:c,oldTags:g.prop("defaultValue")},success:function(c){c.success?p(a,d):i(d,c.errors.Tags,j())},error:function(){p(a,d)}})},e))})}}function o(a){var d=a.find(f);d.length&&d.blur(function(){c.push(setTimeout(function(){var c=d.val(),c=$.trim(c);if(0==c.length)p(a,d);else{var e=d.data("min-length");e&&c.length<e?i(d,["Your edit summary must be at least "+e+" characters."],j()):(e=d.data("max-length"))&&c.length>e?i(d,["Your edit summary cannot be longer than "+e+
" characters."],j()):p(a,d)}},e))})}function t(a){var d=a.find(v);d.length&&d.blur(function(){c.push(setTimeout(function(){var c=d.val(),c=$.trim(c);if(0==c.length)p(a,d);else{var e=d.data("min-length");e&&c.length<e?i(d,["Wiki Excerpt must be at least "+e+" characters; you entered "+c.length+"."],j()):(e=d.data("max-length"))&&c.length>e?i(d,["Wiki Excerpt cannot be longer than "+e+" characters; you entered "+c.length+"."],j()):p(a,d)}},e))})}function s(b){var d=b.find(a);d.length&&d.blur(function(){c.push(setTimeout(function(){var a=
d.val();0==$.trim(a).length?p(b,d):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,20}$/i.test(a)?p(b,d):i(d,["This email does not appear to be valid."],C())},e))})}function j(){var a=$("#sidebar, .sidebar").first().width()||270;return{position:{my:"left top",at:"right center"},css:{"max-width":a,"min-width":a},closeOthers:!1}}function C(){return{position:{my:"left top",at:"right center"},css:{"min-width":$("#sidebar, .sidebar").first().width()||270},closeOthers:!1}}function y(b,d,c,e){if(b){var l=function(){var c=
0;i(d.find(h),b.Title,j())?c++:p(d,d.find(h));i(d.find(w),b.Body,j())?c++:p(d,d.find(w));i(d.find(E),b.Tags,j())?c++:p(d,d.find(E));i(d.find(f),b.EditComment,j())?c++:p(d,d.find(f));i(d.find(v),b.Excerpt,j())?c++:p(d,d.find(v));i(d.find(a),b.Email,C())?c++:p(d,d.find(a));var g=d.find(".general-error"),l=b.General&&0<b.General.length;l||0<c?(g.length||(d.find('input[type="submit"]:visible').before('<div class="general-error-container"><div class="general-error"></div><br class="cbt" /></div>'),g=d.find(".general-error")),
l?i(g,b.General,{position:"inline",css:{"float":"left","margin-bottom":"10px"},closeOthers:!1,dismissable:!1}):(p(d,g),g.text("Your "+e+" couldn't be submitted. Please see the "+(1==c?"error":"errors")+" above."))):d.find(".general-error-container").remove();var n;B()&&($("#sidebar").animate({opacity:0.4},500),n=setInterval(function(){B()||($("#sidebar").animate({opacity:1},500),clearInterval(n))},500));var o;d.find(".validation-error").each(function(){var a=$(this).offset().top;if(!o||a<o)o=a});
c=function(){for(var a=0;3>a;a++)d.find(".message").animate({left:"+=5px"},100).animate({left:"-=5px"},100)};o?(g=$(".review-bar").length,o=Math.max(0,o-(g?125:30)),$("html, body").animate({scrollTop:o},c)):c()},n=function(){1!=c||d.find(E).length?l():setTimeout(n,250)};n()}}function i(a,d,c){if(!d||0==d.length||!a.length)return!1;if((d=1==d.length?d[0]:"<ul><li>"+d.join("</li><li>")+"</li></ul>")&&0<d.length){var e=a.data("error-popup");if(e&&e.is(":visible")){if(a.data("error-message")==d)return!0;
e.fadeOutAndRemove()}c=StackExchange.helpers.showMessage(a,d,c);c.find("a").attr("target","_blank");a.addClass("validation-error");a.data("error-popup",c);a.data("error-message",d);c.click(x);return!0}return!1}function p(a,d){if(!d||0==d.length)return!1;var c=d.data("error-popup");c&&c.is(":visible")&&c.fadeOutAndRemove();d.removeClass("validation-error");d.removeData("error-popup");d.removeData("error-message");a.find(".validation-error").length||a.find(".general-error-container").remove();return!0}
function B(){var a=!1,c=$("#sidebar, .sidebar").first();if(!c.length)return!1;var e=c.offset().left;$(".message").each(function(){var c=$(this);if(c.offset().left+c.outerWidth()>e)return a=!0,!1});return a}var h="input#title",w="textarea.wmd-input:first",E=".tag-editor",f="input[id^=edit-comment]",v="textarea#excerpt",a="input#m-address",c=[],e=250;return{initOnBlur:n,initOnBlurAndSubmit:function(a,c,e,f,h){n(a,c,f);var i,j=function(f){if(f.success)if(h)h(f);else{var k=window.location.href.split("#")[0],
l=f.redirectTo.split("#")[0];0==l.indexOf("/")&&(l=window.location.protocol+"//"+window.location.hostname+l);i=!0;window.location=f.redirectTo;k.toLowerCase()==l.toLowerCase()&&window.location.reload(!0)}else f.captchaHtml?StackExchange.captcha.init(f.captchaHtml,j):f.errors?y(f.errors,a,c,e):a.find('input[type="submit"]:visible').parent().showErrorMessage(f.message)};a.submit(function(){if(a.find("#answer-from-ask").is(":checked"))return!0;x();StackExchange.navPrevention&&StackExchange.navPrevention.stop();
a.find('input[type="submit"]:visible').parent().addSpinner();StackExchange.helpers.disableSubmitButton(a);setTimeout(function(){$.ajax({type:"POST",dataType:"json",data:a.serialize(),url:a.attr("action"),success:j,error:function(){a.find('input[type="submit"]:visible').parent().showErrorMessage("An error occurred submitting the "+e+".")},complete:function(){StackExchange.helpers.removeSpinner();i||StackExchange.helpers.enableSubmitButton(a)}})},0);return!1})},showErrorsAfterSubmission:y,getSidebarPopupOptions:j}}();
